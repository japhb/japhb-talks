.PS

define white_text { "<tspan font-weight=\"bold\" fill=\"white\">" + $1 + "</tspan>" }

define perl6_box { [
    box white_text($1) shaded "orange" outlined "darkorange" wid 1.0;
] }

define nqp_box { [
    box white_text($1) shaded "green" outlined "darkgreen" wid 1.0;
] }

define nqp_box_big { [
    box white_text($1) white_text($2) shaded "green" outlined "darkgreen" wid 1.0 ht .75;
] }

define spec_box { [
    box white_text($1) shaded "darkred" outlined "darkred" wid 1.0;
] }

define vm_box { [
    box white_text($1) colored "black" wid 1.0;
] }

define compiler { [
    down;
    box invis $1;
    nqp_box("Grammar");
    nqp_box("Actions");
    nqp_box("World");
    nqp_box_big("Meta", "Objects");
    nqp_box_big("CORE", "Setting");
] }

define vm_ast { [
    down;
    spec_box($1);
    move;
    vm_box($2);
] }

define keyitem { [
    right;
    box shaded $1 outlined $2 wid 0.2 ht 0.2;
    box $3 invis wid 1.0 ht 0.2;
] }


down;

TOP: [
    right;
    Rakudo: compiler("Rakudo");
    arrow "" "Uses";
    NQP: compiler("NQP (Bootstrapped)");
]

move;

Abstraction: [
    right;
    box invis "VM" "Abstraction";
    move;
    nqp_box("QAST");
    move;
    spec_box("6model");
    move;
    spec_box("nqp::ops");
]

move;

VMs: [
    right;
    box invis "VM" "Specific";
    move;
    vm_ast("PIRT", "Parrot");
    move;
    vm_ast("JAST", "JVM");
    move;
    vm_ast("MAST", "MoarVM");
]

move;

Key: [
    box;
    right;
    keyitem("green", "darkgreen", "Perl 6");
    keyitem("orange", "darkorange", "NQP");
    keyitem("darkred", "darkred", "VM Specific");
    keyitem("black", "black", "VM");
]
.PE
